"use strict";(self.webpackChunkhelp=self.webpackChunkhelp||[]).push([[8075],{62719:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>l,default:()=>d,frontMatter:()=>c,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"api/project/project-create","title":"Project Create","description":"API Endpoint","source":"@site/docs/api/project/09-project-create.md","sourceDirName":"api/project","slug":"/api/project/project-create","permalink":"/api/project/project-create","draft":false,"unlisted":false,"editUrl":"https://github.com/testomato/help.testomato.com/edit/master/docs/api/project/09-project-create.md","tags":[],"version":"current","lastUpdatedAt":1665325519000,"sidebarPosition":9,"frontMatter":{"title":"Project Create"}}');var r=n(74848),o=n(28453);const c={title:"Project Create"},l=void 0,i={},a=[{value:"API Endpoint",id:"api-endpoint",level:3},{value:"Request params",id:"request-params",level:3},{value:"Authenticate user",id:"authenticate-user",level:3},{value:"Example",id:"example",level:3}];function p(e){const t={a:"a",code:"code",h3:"h3",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h3,{id:"api-endpoint",children:"API Endpoint"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-text",children:"POST /api/project/create?period=[period]\n"})}),"\n",(0,r.jsx)(t.h3,{id:"request-params",children:"Request params"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Description"}),(0,r.jsx)(t.th,{children:"Mandatory"})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"period"})}),(0,r.jsxs)(t.td,{children:["Check period interval ",(0,r.jsx)(t.code,{children:"5 minutes"}),", ",(0,r.jsx)(t.code,{children:"30 minutes"}),", ",(0,r.jsx)(t.code,{children:"1 hour"}),", ",(0,r.jsx)(t.code,{children:"8 hours"})," ,",(0,r.jsx)(t.code,{children:"1 day"})," or ",(0,r.jsx)(t.code,{children:"7 days"})]}),(0,r.jsx)(t.td,{children:"optional"})]})})]}),"\n",(0,r.jsx)(t.p,{children:"Payload data:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Parameter"}),(0,r.jsx)(t.th,{children:"Description"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"urls"})}),(0,r.jsx)(t.td,{children:"array of URLs that will be add as new Testomato projects"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"blank"})}),(0,r.jsx)(t.td,{children:"boolean parameter specifies whether the preset check will be added automatically or not"})]})]})]}),"\n",(0,r.jsx)(t.h3,{id:"authenticate-user",children:"Authenticate user"}),"\n",(0,r.jsxs)(t.p,{children:["First you have to retrieve ",(0,r.jsx)(t.code,{children:"SESSION_ID"})," from us:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:'curl -X POST -F "login=email@example.com" -F "password=123456" https://www.testomato.com/api/auth/login\n'})}),"\n",(0,r.jsxs)(t.p,{children:["You can use ",(0,r.jsx)(t.a,{href:"http://php.net/manual/en/book.curl.php",children:"standard CURL from PHP"})," to retrieve ",(0,r.jsx)(t.code,{children:"SESSION_ID"}),". We are expect here ",(0,r.jsx)(t.strong,{children:"password"})," and ",(0,r.jsx)(t.strong,{children:"user login"})," (email) as POST field:"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, 'https://www.testomato.com/api/auth/login');\ncurl_setopt($curl, CURLOPT_POST, true);\ncurl_setopt($curl, CURLOPT_POSTFIELDS, ['login' => 'email@example.com', 'password' => '123456']);\ncurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n$session_id = json_decode(curl_exec($curl))->session->id;\n"})}),"\n",(0,r.jsx)(t.p,{children:"You are getting from us valid JSON response with following content:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-json",children:'{\n\t"id": "123",\n\t"isLoggedIn": true,\n\t"session": {\n\t\t"id": "4as56d4asf46456f654"\n\t}\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["Now you have ",(0,r.jsx)(t.a,{href:"http://php.net/manual/en/function.session-id.php",children:"SESSION_ID"}),". The ",(0,r.jsx)(t.code,{children:"SESSION_ID"})," need to be used in ",(0,r.jsx)(t.code,{children:"/api/project/create"})," POST request"]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"$url = sprintf(\"https://www.testomato.com/api/project/create?%s\", http_build_query(['period' => $period]));\n\n$data = json_encode(['urls' => ['https://example.com'], 'blank' => $blank]);\n\n$curl = curl_init();\ncurl_setopt($curl, CURLOPT_URL, $url);\ncurl_setopt($curl, CURLOPT_POST, true);\ncurl_setopt($curl, CURLOPT_COOKIE, sprintf(\"PHPSESSID=%s; path=/\", $session_id));\ncurl_setopt($curl, CURLOPT_POSTFIELDS, $data);\ncurl_setopt($curl, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);\ncurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n$response = curl_exec($curl);\n"})}),"\n",(0,r.jsx)(t.h3,{id:"example",children:"Example"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\n/**\n * Testomato API example\n *\n * @author Roman O\u017eana <roman@ozana.cz>\n */\nclass TestomatoApi {\n\n\tconst URL = 'https://www.testomato.com/api/';\n\tconst AGENT = 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.71 Safari/537.36';\n\n\tstatic string $session_id = '';\n\n\t/**\n\t * @throws Exception\n\t */\n\tpublic static function login(string $login, string $password): stdClass {\n\t\t$curl = curl_init();\n\t\tcurl_setopt($curl, CURLOPT_URL, sprintf(\"%s/auth/login\", self::URL));\n\t\tcurl_setopt($curl, CURLOPT_POST, true);\n\t\tcurl_setopt($curl, CURLOPT_POSTFIELDS, ['login' => $login, 'password' => $password]);\n\t\tcurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n\t\t$response = json_decode(curl_exec($curl));\n\n\t\tif (\n\t\t\tisset($response->session->id) && $response->session->id &&\n\t\t\tisset($response->isLoggedIn) && $response->isLoggedIn\n\t\t) {\n\t\t\tstatic::$session_id = $response->session->id;\n\t\t\treturn $response;\n\t\t} else {\n\t\t\tthrow new Exception('Login was not successful!' . isset($response->messsage) ? ' ' . $response->message : null);\n\t\t}\n\t}\n\n\tpublic static function addProjects(array $urls, $blank = false, $period = '5 minutes'): Generator {\n\t\t$url = sprintf(\"%s/project/create?%s\", self::URL, http_build_query(['period' => $period]));\n\n\t\t$data = json_encode(['urls' => $urls, 'blank' => $blank]);\n\n\t\t$curl = curl_init();\n\t\tcurl_setopt($curl, CURLOPT_URL, $url);\n\t\tcurl_setopt($curl, CURLOPT_POST, true);\n\t\tcurl_setopt($curl, CURLOPT_USERAGENT, self::AGENT);\n\t\tcurl_setopt($curl, CURLOPT_COOKIE, sprintf(\"PHPSESSID=%s; path=/\", static::$session_id));\n\t\tcurl_setopt($curl, CURLOPT_POSTFIELDS, $data);\n\t\tcurl_setopt($curl, CURLOPT_HTTPHEADER, ['Content-Type: application/json']);\n\t\tcurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n\t\t$response = str_replace('}{', \"}\\n{\", curl_exec($curl));\n\n\t\tforeach (explode(\"\\n\", $response) as $part) {\n\t\t\tyield json_decode($part);\n\t\t}\n\t}\n\n\t/**\n\t * @throws Exception\n\t */\n\tpublic static function logout(): stdClass {\n\t\t$curl = curl_init();\n\t\tcurl_setopt($curl, CURLOPT_URL, sprintf(\"%s/auth/logout\", self::URL));\n\t\tcurl_setopt($curl, CURLOPT_POST, true);\n\t\tcurl_setopt($curl, CURLOPT_USERAGENT, self::AGENT);\n\t\tcurl_setopt($curl, CURLOPT_COOKIE, sprintf(\"PHPSESSID=%s; path=/\", static::$session_id));\n\t\tcurl_setopt($curl, CURLOPT_RETURNTRANSFER, true);\n\n\t\t$response = json_decode(curl_exec($curl));\n\n\t\tif (isset($response->message)) {\n\t\t\treturn $response;\n\t\t} else {\n\t\t\tthrow new \\Exception('Invalid response format');\n\t\t}\n\n\t}\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"Usage:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-php",children:"<?php\n\nrequire_once __DIR__ . '/TestomatoApi.php';\n\n$login = TestomatoApi::login('exampl@email.com', '123456'); // login\n\nforeach (TestomatoApi::addProjects(['https://example.com', 'https://example2.com']) as $response) {\n\tif (isset($response->id)) {\n\t\tprintf(\"https://www.testomato.com/project/%s/#/tests\\n\", $response->id);\n\t}\n}\n\necho TestomatoApi::logout()->message; // logout\n"})})]})}function d(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>l});var s=n(96540);const r={},o=s.createContext(r);function c(e){const t=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);